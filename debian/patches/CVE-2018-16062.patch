Index: elfutils-0.159/libdw/dwarf_getaranges.c
===================================================================
--- elfutils-0.159.orig/libdw/dwarf_getaranges.c	2019-02-19 15:51:38.839827649 +0100
+++ elfutils-0.159/libdw/dwarf_getaranges.c	2019-02-19 15:51:38.827827649 +0100
@@ -140,6 +140,10 @@
 				   length_bytes, &offset, IDX_debug_info, 4))
 	goto fail;
 
+      /* Next up two bytes for address and segment size.  */
+      if (readp + 2 > readendp)
+	goto invalid;
+
       unsigned int address_size = *readp++;
       if (address_size != 4 && address_size != 8)
 	goto invalid;
Index: elfutils-0.159/src/readelf.c
===================================================================
--- elfutils-0.159.orig/src/readelf.c	2019-02-19 15:51:38.839827649 +0100
+++ elfutils-0.159/src/readelf.c	2019-02-19 15:51:38.827827649 +0100
@@ -4618,6 +4618,8 @@
 	  goto next_table;
 	}
 
+      if (readp + 1 > readendp)
+	goto invalid_data;
       unsigned int segment_size = *readp++;
       printf (gettext (" Segment size:  %6" PRIu64 "\n\n"),
 	      (uint64_t) segment_size);
